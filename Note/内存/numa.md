- [[#base|base]]
		- [[#非统一内存访问|非统一内存访问]]
		- [[#本地内存访问优势|本地内存访问优势]]
		- [[#numa比率|numa比率]]
- [[#numa“陷阱”|numa“陷阱”]]
	- [[#numa“陷阱”#numa的内存回收|numa的内存回收]]

### base

##### 非统一内存访问
‌‌‌‌　　- `每个CPU被分配自己的本地内存，并且可以从系统的其他CPU共享内存`
‌‌‌‌　　- `单个numa节点通过IO总线连接将cpu连接到计算机上任何数量的可用内存`
##### 本地内存访问优势
	低延迟高带宽
##### numa比率
	访问外部内存成本与访问本地内存成本的比率。比例越大，成本就越大，因此访问内存所需的时间就越长

### numa“陷阱”
#### numa的内存回收
- zone_reclaim_mode
	- 关闭zone_reclaim模式，可以从其他zone或NUMA节点回收内存
	- 打开zone_reclaim模式，这样内存回收只会发生在本地节点内
		- 可以将cache中的脏数据写回硬盘，以回收内存
		- 在本地回收内存时，表示可以用Swap 方式回收内存
- 但是以上的情况是通过只会在绑定cpu和mem的亲和性之后才会出现
- 绑定num亲和性虽然性能高一些，但是容易触发"陷阱"
	- 内存用完之后会使用swap
	- swap超过一定限制之后会kill 进程